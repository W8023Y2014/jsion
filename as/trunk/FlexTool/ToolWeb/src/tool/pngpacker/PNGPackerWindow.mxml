<?xml version="1.0" encoding="utf-8"?>
<tool:BaseTitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009" 
			   xmlns:s="library://ns.adobe.com/flex/spark" 
			   xmlns:mx="library://ns.adobe.com/flex/mx"
			   xmlns:tool="tool.*"
			   title="动作序列帧压缩打包"
			   width="800" height="520"
			   initialize="basetitlewindow1_initializeHandler(event)" xmlns:pngpacker="tool.pngpacker.*">
	<fx:Script>
		<![CDATA[
			import mx.events.CloseEvent;
			import mx.events.FlexEvent;
			import mx.managers.PopUpManager;
			
			import tool.pngpacker.events.PackerEvent;
			
			protected var m_timer:Timer;
			
			override protected function titlewindow1_closeHandler(event:CloseEvent):void
			{
				clearTimer();
				
				super.titlewindow1_closeHandler(event);
			}

			protected function basetitlewindow1_initializeHandler(event:FlexEvent):void
			{
				// TODO Auto-generated method stub
				
				m_timer = new Timer(1000 / 30);
				
				m_timer.addEventListener(TimerEvent.TIMER, __timerHandler);
				
				m_timer.start();
			}
			
			protected function __timerHandler(e:TimerEvent):void
			{
				//trace("FPS");
			}

			protected function spinnerinput1_textChangedHandler(event:PackerEvent):void
			{
				// TODO Auto-generated method stub
				
				var i:int = int(fpsInput.text);
				
				if(i <= 0)
				{
					fpsInput.text = "1";
					i = 1;
				}
				
				resetTimer(i);
			}
			
			protected function resetTimer(fps:Number):void
			{
				clearTimer();
				
				m_timer = new Timer(1000 / fps);
				
				m_timer.addEventListener(TimerEvent.TIMER, __timerHandler);
				
				m_timer.start();
			}
			
			protected function clearTimer():void
			{
				if(m_timer)
				{
					m_timer.reset();
					m_timer.removeEventListener(TimerEvent.TIMER, __timerHandler);
					m_timer = null;
				}
			}
			
			protected function button1_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				PopUpManager.centerPopUp(PopUpManager.createPopUp(ToolGlobal.windows, CreateActionFrame, true));
			}
			
		]]>
	</fx:Script>
	<fx:Declarations>
		<!-- 将非可视元素（例如服务、值对象）放在此处 -->
	</fx:Declarations>
	<mx:Accordion left="10" top="48" bottom="10" width="152">
		<s:NavigatorContent width="100%" height="100%" label="测试一">
		</s:NavigatorContent>
		<s:NavigatorContent width="100%" height="100%" label="测试二">
		</s:NavigatorContent>
	</mx:Accordion>
	<s:BorderContainer left="10" right="10" top="5" height="38">
		<s:HGroup left="0" right="0" top="0" bottom="0" paddingBottom="5" paddingLeft="5"
				  paddingRight="5" paddingTop="5">
			<s:Button height="25" label="添加动作" click="button1_clickHandler(event)"/>
			<s:Button label="删除动作" height="25"/>
			<s:Button label="打包保存" height="25"/>
			<pngpacker:SpinnerInput id="fpsInput" defaultText="0" restrict="0-9" text="30" textChanged="spinnerinput1_textChangedHandler(event)">
			</pngpacker:SpinnerInput>
		</s:HGroup>
	</s:BorderContainer>
</tool:BaseTitleWindow>
